{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://turnix.dev/schemas/pack-manifest.schema.json",
  "title": "Turnix Pack Manifest",
  "description": "Manifest file describing a Turnix pack (appPack, viewPack, mod, contentPack, savePack).",
  "type": "object",
  "additionalProperties": true,

  "required": ["id", "kind"],

  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[A-Za-z0-9_-]+$",
      "description": "Local pack id. Must match the filesystem-safe pattern /^[A-Za-z0-9_-]+$/."
    },

    "name": {
      "type": "string",
      "description": "User-facing pack name. Defaults to `id` when omitted."
    },

    "kind": {
      "type": "string",
      "description": "Pack kind controls how the engine treats this pack.",
      "enum": ["appPack", "viewPack", "mod", "contentPack", "savePack"]
    },

    "version": {
      "type": "string",
      "description": "Semantic version string for this pack (for example, \"1.0.0\", \"2.1.0-beta\"). Parsed as SemVer when possible."
    },

    "author": {
      "description": "Author metadata. Either a simple string or an object with a `name` field.",
      "oneOf": [
        {
          "type": "string",
          "description": "Simple author name (for example, \"Turnix Team\")."
        },
        {
          "type": "object",
          "description": "Structured author description.",
          "properties": {
            "name": {
              "type": "string",
              "description": "Canonical author name."
            },
            "url": {
              "type": "string",
              "format": "uri",
              "description": "Homepage or project URL."
            },
            "email": {
              "type": "string",
              "format": "email",
              "description": "Contact email."
            }
          },
          "required": ["name"],
          "additionalProperties": true
        }
      ]
    },

    "description": {
      "type": "string",
      "description": "Short description of what this pack provides."
    },

    "visibility": {
      "type": "string",
      "description": "Visibility hint. Affects default importFromParent and inheritance behaviour.",
      "enum": ["public", "private"]
    },

    "importFromParent": {
      "type": "boolean",
      "description": "If true, this pack inherits exports/config from its parent. Defaults to false for viewPack and true for other kinds."
    },

    "exports": {
      "type": "object",
      "description": "Named exports from this pack that other packs can import. Shape is intentionally open-ended.",
      "additionalProperties": true
    },

    "mods": {
      "type": "object",
      "description": "Hard mod dependencies for appPack/viewPack. Keys are mod packTreeIds, values are SemVer ranges or full PackRefStrings.",
      "patternProperties": {
        "^[A-Za-z0-9_.-]+$": {
          "description": "SemVer requirement (for example, \"^1.0.0\") or PackRefString (for example, \"Author@mod-id@^1.0.0\").",
          "type": ["string", "null"]
        }
      },
      "additionalProperties": false
    },

    "recommendedPacks": {
      "type": "array",
      "description": "Optional or recommended packs that complement this pack.",
      "items": {
        "$ref": "#/$defs/packRefString"
      }
    },

    "supportedPacks": {
      "type": "array",
      "description": "Known-compatible packs that this pack explicitly supports.",
      "items": {
        "$ref": "#/$defs/packRefString"
      }
    },

    "unsupportedPacks": {
      "type": "array",
      "description": "Packs that are known to be incompatible with this one.",
      "items": {
        "$ref": "#/$defs/packRefString"
      }
    }
  },

  "$defs": {
    "packRefString": {
      "type": "string",
      "description": "Textual pack selector in the form [<author>@]<packTreeId>[@<SemVerPackRequirement>].",
      "examples": [
        "avatars",
        "Anthony@avatars",
        "main-menu@2.3.4",
        "Turnix@ui.trace-list@2.5.3",
        "Turnix@main-menu.ui@^3"
      ]
    }
  }
}
